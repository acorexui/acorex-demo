<div class="ax-max-w-[100vw] ax-max-h-[100vh]">
  <ax-kanban
    class="ax-p-4"
    [itemTemplate]="item"
    [statuses]="statuses()"
    [headerTemplate]="header"
    [footerTemplate]="footer"
    [dataSource]="dataSource()"
    (onSortChanged)="sort($event)"
    [contentFooterTemplate]="contentFooter"
  ></ax-kanban>
</div>

<!-- Custom Header Template -->
<ng-template #header let-status>
  <div class="ax-flex ax-flex-col ax-gap-2 ax-px-4 ax-py-2">
    <ax-title>{{ status.title }}</ax-title>
    <ax-subtitle class="ax-text-xs ax-opacity-70">
      {{ getItemCount(status.key) }} items
    </ax-subtitle>
  </div>
</ng-template>

<!-- Custom Footer Template -->
<ng-template #footer let-status>
  <div
    class="ax-flex ax-justify-between ax-items-center ax-text-xs ax-opacity-70 ax-px-4 ax-py-2 ax-w-full"
  >
    <span>Total: {{ getItemCount(status.key) }}</span>
    <span>
      High:
      {{
        getPriorityCount(status.key, "high") +
          getPriorityCount(status.key, "highest")
      }}
    </span>
  </div>
</ng-template>

<!-- Custom Content Footer Template -->
<ng-template #contentFooter let-status>
  <div class="ax-flex ax-justify-center ax-py-2">
    <ax-button
      class="ax-sm"
      look="outline"
      [text]="`Add Item to ${ status.title }`"
    ></ax-button>
  </div>
</ng-template>

<!-- Custom Item Template -->
<ng-template #item let-item>
  <div
    class="ax-flex ax-flex-col ax-gap-2 ax-p-3 ax-surface ax-rounded-lg ax-shadow-sm ax-border"
  >
    <div class="ax-flex ax-justify-between ax-items-start">
      <ax-title class="ax-text-sm ax-font-medium">{{ item.title }}</ax-title>
      <ax-subtitle
        class="ax-text-xs ax-px-2 ax-py-1 ax-rounded-full"
        [ngClass]="{
          'ax-bg-red-100 ax-text-red-800': item.priority === 'highest',
          'ax-bg-orange-100 ax-text-orange-800': item.priority === 'high',
          'ax-bg-yellow-100 ax-text-yellow-800': item.priority === 'medium',
          'ax-bg-green-100 ax-text-green-800': item.priority === 'low',
          'ax-bg-blue-100 ax-text-blue-800': item.priority === 'lowest',
          'ax-bg-gray-100 ax-text-gray-800': !item.priority
        }"
      >
        {{ item.priority || "none" }}
      </ax-subtitle>
    </div>
    <ax-subtitle>{{ item.description }}</ax-subtitle>
    <div class="ax-flex ax-justify-between ax-items-center ax-text-xs">
      <span>ID: {{ item.id }}</span>
      <span>{{ item.statusKey }}</span>
    </div>
  </div>
</ng-template>
